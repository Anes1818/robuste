<!DOCTYPE html>
<html dir="rtl" lang="ar">
<head>
<meta name="description" content="Robuste eulma - منتجات كهربائية منزلية عالية الجودة مع ضمان وسرعة توصيل في الجزائر">
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">

<!-- Favicon -->
<link rel="shortcut icon" href="images/favicon.ico" type="image/x-icon">
<link rel="apple-touch-icon" sizes="180x180" href="images/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="images/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="images/favicon-16x16.png">

<!-- Theme color -->
<meta name="theme-color" content="#FF6B35">
<title>Robuste eulma - المنتج</title>

<!-- Google Fonts -->
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700;800&display=swap" rel="stylesheet">

<!-- Bootstrap RTL -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.rtl.min.css" rel="stylesheet">

<!-- Bootstrap Icons -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">

<!-- EmailJS -->
<script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>

<!-- أسلوب صفحة المنتج المتوافق -->
<style>
    :root {
        --primary: #FF6B35;
        --primary-dark: #E05A2B;
        --secondary: #FFF8F0;
        --light: #FFFFFF;
        --dark: #333333;
        --gray: #6C757D;
        --success: #28a745;
        --danger: #dc3545;
        --border-color: #e7e7e7;
        --shadow-color: rgba(0, 0, 0, 0.1);
        --amazon-bg: #EAEDED;
        --amazon-border: #DDD;
        --amazon-text: #0F1111;
        --amazon-price: #B12704;
        --amazon-yellow: #FFD814;
        --amazon-orange: #FFA41C;
    }

    /* وضع الظلام */
    :root[data-theme="dark"] {
        --primary: #FF8C42;
        --primary-dark: #FF6B35;
        --secondary: #121212;
        --light: #1e1e1e;
        --dark: #f5f5f5;
        --gray: #a0a0a0;
        --success: #4CAF50;
        --danger: #f44336;
        --border-color: rgba(255, 255, 255, 0.1);
        --shadow-color: rgba(0, 0, 0, 0.3);
        --amazon-bg: #0F1111;
        --amazon-border: rgba(255, 255, 255, 0.1);
        --amazon-text: #f5f5f5;
        --amazon-price: #FF8C42;
    }

    body {
        font-family: 'Tajawal', sans-serif;
        background-color: var(--amazon-bg);
        color: var(--amazon-text);
        padding-top: 56px;
        transition: background-color 0.3s ease, color 0.3s ease;
    }

    /* ============== تحسينات وضع الظلام ============== */
    [data-theme="dark"] .navbar {
        background-color: #1a1a1a !important;
        box-shadow: 0 2px 15px rgba(0, 0, 0, 0.3);
        border-bottom: 1px solid var(--border-color);
    }

    [data-theme="dark"] .navbar-brand {
        color: var(--primary) !important;
    }

    [data-theme="dark"] .nav-link {
        color: var(--dark) !important;
        opacity: 0.9;
    }

    [data-theme="dark"] .nav-link:hover {
        color: var(--primary) !important;
        opacity: 1;
    }

    [data-theme="dark"] .nav-link.active {
        color: var(--primary) !important;
        font-weight: 600;
    }

    [data-theme="dark"] .product-section {
        background-color: #121212;
    }

    [data-theme="dark"] .product-card {
        background: var(--light);
        border: 1px solid var(--border-color);
    }

    [data-theme="dark"] .product-details {
        background: var(--light);
        border: 1px solid var(--border-color);
    }

    /* ============== تصميم يشبه أمازون ============== */
    .product-section {
        padding: 40px 0;
        background-color: var(--amazon-bg);
    }

    .product-container {
        display: flex;
        gap: 30px;
        margin-bottom: 50px;
        flex-wrap: wrap;
    }

    /* معرض الصور */
    .product-gallery {
        flex: 1;
        min-width: 300px;
        background: white;
        border-radius: 8px;
        padding: 20px;
        box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        border: 1px solid var(--amazon-border);
    }

    .main-image-container {
        position: relative;
        height: 500px;
        display: flex;
        align-items: center;
        justify-content: center;
        background: white;
        border-radius: 8px;
        overflow: hidden;
        margin-bottom: 15px;
        border: 1px solid var(--amazon-border);
    }

    .main-image {
        max-width: 100%;
        max-height: 100%;
        object-fit: contain;
        transition: transform 0.3s ease;
    }

    .thumbnail-container {
        display: flex;
        gap: 10px;
        overflow-x: auto;
        padding: 10px 0;
    }

    .thumbnail {
        width: 80px;
        height: 80px;
        border-radius: 4px;
        overflow: hidden;
        cursor: pointer;
        border: 2px solid transparent;
        transition: all 0.3s ease;
        flex-shrink: 0;
        border: 1px solid var(--amazon-border);
        background: white;
    }

    .thumbnail.active {
        border-color: var(--primary);
        box-shadow: 0 0 0 2px rgba(255, 107, 53, 0.3);
    }

    .thumbnail img {
        width: 100%;
        height: 100%;
        object-fit: cover;
    }

    /* تفاصيل المنتج */
    .product-details {
        flex: 1;
        min-width: 300px;
        background: white;
        border-radius: 8px;
        padding: 30px;
        box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        border: 1px solid var(--amazon-border);
    }

    .product-title {
        font-size: 1.8rem;
        font-weight: 700;
        margin-bottom: 10px;
        color: var(--amazon-text);
        line-height: 1.3;
    }

    .product-rating {
        display: flex;
        align-items: center;
        gap: 10px;
        margin-bottom: 20px;
    }

    .stars {
        color: var(--amazon-orange);
        font-size: 1.1rem;
    }

    .rating-count {
        color: var(--gray);
        font-size: 0.9rem;
    }

    .price-section {
        margin-bottom: 25px;
        padding-bottom: 20px;
        border-bottom: 1px solid var(--amazon-border);
    }

    .current-price {
        font-size: 2.2rem;
        font-weight: 700;
        color: var(--amazon-price);
        margin-bottom: 5px;
    }

    .old-price {
        font-size: 1.2rem;
        color: var(--gray);
        text-decoration: line-through;
        margin-left: 10px;
    }

    .discount-badge {
        display: inline-block;
        background: var(--danger);
        color: white;
        padding: 4px 8px;
        border-radius: 4px;
        font-size: 0.9rem;
        font-weight: 700;
        margin-right: 10px;
    }

    .product-description {
        font-size: 1.1rem;
        line-height: 1.6;
        color: #555;
        margin-bottom: 25px;
    }

    .features-list {
        margin: 25px 0;
    }

    .features-list li {
        margin-bottom: 10px;
        padding-right: 25px;
        position: relative;
        font-size: 1rem;
        line-height: 1.5;
    }

    .features-list li:before {
        content: "✓";
        position: absolute;
        right: 0;
        color: var(--success);
        font-weight: bold;
        font-size: 1.2rem;
    }

    .stock-status {
        display: flex;
        align-items: center;
        gap: 10px;
        margin: 25px 0;
        padding: 12px 16px;
        background: rgba(40, 167, 69, 0.1);
        border-radius: 8px;
        border: 1px solid rgba(40, 167, 69, 0.2);
    }

    .stock-status.in-stock i {
        color: var(--success);
    }

    .stock-status.out-of-stock {
        background: rgba(220, 53, 69, 0.1);
        border-color: rgba(220, 53, 69, 0.2);
    }

    .stock-status.out-of-stock i {
        color: var(--danger);
    }

    /* أزرار الإجراء */
    .action-buttons {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 15px;
        margin-top: 30px;
    }

    .btn-amazon {
        background: var(--amazon-yellow);
        border: none;
        border-radius: 20px;
        padding: 12px 20px;
        font-size: 1.1rem;
        font-weight: 700;
        color: #111;
        cursor: pointer;
        transition: all 0.2s;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 8px;
        min-height: 48px;
        text-align: center;
    }

    .btn-amazon:hover {
        background: #F7CA00;
    }

    .btn-amazon-primary {
        background: var(--amazon-orange);
        color: white;
    }

    .btn-amazon-primary:hover {
        background: #FA8900;
    }

    /* معلومات الشحن */
    .shipping-info {
        margin-top: 30px;
        padding: 20px;
        background: rgba(248, 249, 250, 0.5);
        border-radius: 8px;
        border: 1px solid var(--amazon-border);
    }

    .shipping-info .item {
        display: flex;
        align-items: center;
        gap: 12px;
        margin-bottom: 12px;
    }

    .shipping-info .item i {
        color: var(--primary);
        font-size: 1.2rem;
        min-width: 24px;
    }

    /* قسم المنتجات المشابهة */
    .related-products {
        margin-top: 60px;
        padding-top: 40px;
        border-top: 1px solid var(--amazon-border);
    }

    .section-title {
        position: relative;
        margin-bottom: 30px;
        padding-bottom: 15px;
        font-weight: 800;
        color: var(--amazon-text);
        text-align: center;
        font-size: 1.8rem;
    }

    .section-title::after {
        content: '';
        position: absolute;
        bottom: 0;
        right: 50%;
        transform: translateX(50%);
        width: 80px;
        height: 4px;
        background-color: var(--primary);
        border-radius: 2px;
    }

    .products-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
        gap: 20px;
        margin-top: 30px;
    }

    .product-card {
        border: 1px solid var(--amazon-border);
        border-radius: 8px;
        overflow: hidden;
        background: white;
        transition: all 0.3s ease;
        height: 100%;
        display: flex;
        flex-direction: column;
    }

    .product-card:hover {
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        transform: translateY(-3px);
    }

    .product-card-image {
        height: 200px;
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 15px;
        background: #f8f8f8;
    }

    .product-card-image img {
        max-width: 100%;
        max-height: 100%;
        object-fit: contain;
    }

    .product-card-content {
        padding: 15px;
        flex-grow: 1;
        display: flex;
        flex-direction: column;
    }

    .product-card-title {
        font-size: 0.95rem;
        font-weight: 600;
        color: var(--amazon-text);
        margin-bottom: 8px;
        line-height: 1.4;
        height: 40px;
        overflow: hidden;
        display: -webkit-box;
        -webkit-line-clamp: 2;
        -webkit-box-orient: vertical;
    }

    .product-card-price {
        font-size: 1.1rem;
        font-weight: 700;
        color: var(--amazon-price);
        margin-top: auto;
    }

    .product-card-old-price {
        font-size: 0.9rem;
        color: var(--gray);
        text-decoration: line-through;
        margin-left: 5px;
    }

    .product-card-btn {
        width: 100%;
        background: var(--amazon-yellow);
        border: none;
        border-radius: 8px;
        padding: 8px;
        font-size: 0.9rem;
        font-weight: 600;
        color: #111;
        cursor: pointer;
        transition: all 0.2s;
        margin-top: 10px;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 5px;
    }

    .product-card-btn:hover {
        background: #F7CA00;
    }

    /* ============== تصميم متجاوب ============== */
    @media (max-width: 992px) {
        .product-container {
            flex-direction: column;
        }

        .main-image-container {
            height: 400px;
        }

        .product-title {
            font-size: 1.5rem;
        }

        .current-price {
            font-size: 1.8rem;
        }

        .action-buttons {
            grid-template-columns: 1fr;
        }

        .products-grid {
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
        }
    }

    @media (max-width: 768px) {
        .main-image-container {
            height: 300px;
        }

        .product-title {
            font-size: 1.3rem;
        }

        .current-price {
            font-size: 1.5rem;
        }

        .product-details {
            padding: 20px;
        }

        .products-grid {
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
        }
    }

    @media (max-width: 576px) {
        .main-image-container {
            height: 250px;
        }

        .thumbnail {
            width: 60px;
            height: 60px;
        }

        .products-grid {
            grid-template-columns: 1fr;
        }
    }

    /* ============== أنماط مشتركة مع الموقع الرئيسي ============== */
    .navbar {
        background-color: var(--light);
        box-shadow: 0 2px 15px rgba(0, 0, 0, 0.1);
        transition: all 0.3s ease;
        z-index: 1030;
    }

    .navbar-brand {
        color: var(--primary) !important;
        font-weight: 700;
        font-size: 1.5rem;
    }

    /* زر دارك مود */
    .theme-toggle {
        width: 44px;
        height: 44px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        background: rgba(255, 255, 255, 0.1);
        border: 1px solid rgba(255, 255, 255, 0.2);
        color: var(--dark);
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        cursor: pointer;
        margin-left: 10px;
        position: relative;
        overflow: hidden;
        font-size: 1.2rem;
        z-index: 1002;
        -webkit-tap-highlight-color: transparent;
    }

    [data-theme="light"] .theme-toggle {
        background: rgba(0, 0, 0, 0.05);
        border: 1px solid rgba(0, 0, 0, 0.1);
        color: var(--dark);
    }

    [data-theme="dark"] .theme-toggle {
        background: rgba(255, 255, 255, 0.1);
        border: 1px solid rgba(255, 255, 255, 0.2);
        color: var(--dark);
    }

    .theme-toggle:hover {
        background: var(--primary);
        color: white;
        transform: rotate(15deg) scale(1.1);
        border-color: var(--primary);
    }

    /* أيقونة السلة */
    .cart-icon-container {
        position: relative;
    }

    .cart-btn {
        width: 44px;
        height: 44px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        background: var(--primary);
        color: white;
        border: none;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
        transition: all 0.3s ease;
        text-decoration: none;
        position: relative;
    }

    .cart-btn:hover {
        transform: scale(1.1);
        background: var(--primary-dark);
    }

    #cartCount {
        position: absolute;
        top: -5px;
        right: -5px;
        background-color: var(--danger);
        color: white;
        border-radius: 50%;
        width: 20px;
        height: 20px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 0.7rem;
        font-weight: bold;
        border: 2px solid white;
    }

    /* مؤشر الحالة */
    .status-indicator {
        position: fixed;
        top: 20px;
        right: 20px;
        z-index: 2000;
        max-width: 350px;
    }

    .order-confirmation {
        background-color: rgba(255, 255, 255, 0.95);
        border-left: 5px solid var(--success);
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
    }

    .order-error {
        background-color: rgba(255, 255, 255, 0.95);
        border-left: 5px solid var(--danger);
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
    }

    /* زر واتساب */
    .whatsapp-btn {
        position: fixed;
        bottom: 25px;
        left: 25px;
        z-index: 1001;
        width: 60px;
        height: 60px;
        border-radius: 50%;
        background-color: #25D366;
        color: white;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 28px;
        box-shadow: 0 5px 15px rgba(37, 211, 102, 0.3);
        transition: all 0.3s;
        -webkit-tap-highlight-color: transparent;
    }

    .whatsapp-btn:hover {
        transform: scale(1.1);
    }

    /* فوتر */
    footer {
        background-color: #1a1a1a !important;
        border-top: 1px solid var(--border-color);
        color: var(--dark);
    }

    footer a {
        color: var(--gray) !important;
        transition: color 0.3s ease;
    }

    footer a:hover {
        color: var(--primary) !important;
    }

    .social-icon {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        width: 44px;
        height: 44px;
        border-radius: 50%;
        background-color: rgba(0, 0, 0, 0.1);
        color: var(--dark);
        margin-left: 10px;
        transition: all 0.3s;
        cursor: pointer;
        -webkit-tap-highlight-color: transparent;
    }

    .social-icon:hover {
        background-color: var(--primary);
        color: white;
        transform: translateY(-3px);
    }
</style>
</head>

<body>
    <!-- شريط التنقل -->
    <nav class="navbar navbar-expand-lg navbar-light fixed-top bg-white shadow-sm">
        <div class="container">
            <a class="navbar-brand" href="index.html">
                <img src="https://i.postimg.cc/7P7BK44r/f525e1dd-9f2c-4160-aed1-882a8b28b75c-20250703-131500-0000.png" 
                     alt="Robuste Logo" class="d-inline-block align-top" 
                     style="width: 150px; height: auto; max-height: 40px; object-fit:fill;">
                <span class="d-none d-lg-inline fw-bold fs-4 ms-2" style="color: #FF6B35;">ROBUSTE eulma</span>
            </a>
            
            <!-- زر دارك مود -->
            <div class="d-flex align-items-center me-3">
                <button class="theme-toggle" id="themeToggle" title="تبديل وضع الظلام">
                    <i class="bi bi-moon"></i>
                </button>
            </div>
            
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav me-auto">
                    <li class="nav-item mx-2"><a class="nav-link" href="index.html">الرئيسية</a></li>
                    <li class="nav-item"><a class="nav-link" href="index.html#products">المنتجات</a></li>
                    <li class="nav-item"><a class="nav-link" href="index.html#reviews">آراء العملاء</a></li>
                    <li class="nav-item"><a class="nav-link" href="index.html#contact">اتصل بنا</a></li>
                </ul>
            </div>
            
            <!-- أيقونة السلة مع عداد -->
            <div class="cart-icon-container ms-lg-4">
                <a href="#" class="cart-btn position-relative" onclick="toggleCart(); return false;">
                    <i class="bi bi-cart3"></i>
                    <span class="position-absolute badge rounded-pill bg-danger" id="cartCount">0</span>
                </a>
            </div>
        </div>
    </nav>

    <!-- مؤشر الحالة -->
    <div class="status-indicator" id="statusIndicator" style="display: none;">
        <div class="alert alert-dismissible fade show" role="alert">
            <span id="statusMessage"></span>
            <button type="button" class="btn-close" onclick="hideStatus()"></button>
        </div>
    </div>

    <!-- قسم المنتج الرئيسي -->
    <section class="product-section">
        <div class="container">
            <div class="product-container" id="productContainer">
                <!-- سيتم تعبئته بواسطة JavaScript -->
                <div class="text-center py-5 w-100">
                    <div class="spinner-border text-primary" role="status">
                        <span class="visually-hidden">جاري التحميل...</span>
                    </div>
                    <p class="mt-3">جاري تحميل تفاصيل المنتج...</p>
                </div>
            </div>

            <!-- المنتجات المشابهة -->
            <div class="related-products">
                <h2 class="section-title">منتجات قد تعجبك</h2>
                <div class="products-grid" id="relatedProductsContainer">
                    <!-- سيتم تعبئته بواسطة JavaScript -->
                </div>
            </div>
        </div>
    </section>

    <!-- فوتر -->
    <footer class="py-5 bg-dark text-white">
        <div class="container">
            <div class="row">
                <div class="col-lg-4 mb-4">
                    <h5 class="mb-3">عن ROBUSTE</h5>
                    <p>متجر متخصص في الأجهزة الكهربائية المنزلية عالية الجودة بأسعار تنافسية. نقدم أفضل المنتجات وتوصيل سريع.</p>
                    <div class="mt-3">
                        <a href="https://www.facebook.com/share/19QooaXfy8/" class="social-icon" target="_blank">
                            <i class="bi bi-facebook"></i>
                        </a>
                    </div>
                </div>
                <div class="col-lg-2 col-md-4 mb-4">
                    <h5 class="mb-3">روابط سريعة</h5>
                    <ul class="list-unstyled">
                        <li class="mb-2"><a href="index.html" class="text-white text-decoration-none">الرئيسية</a></li>
                        <li class="mb-2"><a href="index.html#products" class="text-white text-decoration-none">المنتجات</a></li>
                        <li class="mb-2"><a href="index.html#reviews" class="text-white text-decoration-none">آراء العملاء</a></li>
                        <li class="mb-2"><a href="index.html#contact" class="text-white text-decoration-none">اتصل بنا</a></li>
                    </ul>
                </div>
                <div class="col-lg-3 col-md-4 mb-4">
                    <h5 class="mb-3">خدمة العملاء</h5>
                    <ul class="list-unstyled">
                        <li class="mb-2"><a href="#" class="text-white text-decoration-none">الأسئلة الشائعة</a></li>
                        <li class="mb-2"><a href="#" class="text-white text-decoration-none">طرق الدفع</a></li>
                        <li class="mb-2"><a href="#" class="text-white text-decoration-none">شروط الضمان</a></li>
                    </ul>
                </div>
                <div class="col-lg-3 col-md-4 mb-4">
                    <h5 class="mb-3">اشترك في صفحتنا</h5>
                    <p>اشترك لتلقي آخر العروض والتخفيضات</p>
                    <div class="mt-3">
                        <a href="https://www.facebook.com/share/19QooaXfy8/" class="btn btn-orange w-100" target="_blank">
                            اشترك الآن
                        </a>
                    </div>
                </div>
            </div>
            <hr class="my-4 bg-light">
            <div class="row">
                <div class="col-md-6 text-center text-md-start mb-3 mb-md-0">
                    <p class="mb-0">&copy; 2025 ROBUSTE. جميع الحقوق محفوظة.</p>
                </div>
                <div class="col-md-6 text-center text-md-end">
                    <div class="d-flex flex-column flex-md-row align-items-center justify-content-md-end">
                        <p class="mb-2 mb-md-0 me-md-3">الدفع ببطاقة الذهبية متاح</p>
                        <img src="https://i.postimg.cc/bY06X2YN/logo-round.png" alt="طرق الدفع" style="width: 30px; height: auto;">
                    </div>
                </div>
            </div>
        </div>
    </footer>

    <!-- زر واتساب -->
    <a href="https://wa.me/213656360457" class="whatsapp-btn" target="_blank">
        <i class="bi bi-whatsapp"></i>
    </a>

    <!-- سلة المشتريات -->
    <div class="offcanvas offcanvas-end" tabindex="-1" id="cartOffcanvas" aria-labelledby="cartOffcanvasLabel">
        <div class="offcanvas-header">
            <h5 class="offcanvas-title" id="cartOffcanvasLabel">سلة المشتريات</h5>
            <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="إغلاق"></button>
        </div>
        <div class="offcanvas-body">
            <div id="cartItems" class="mb-3">
                <!-- سيتم تعبئته بواسطة JavaScript -->
                <div class="text-center py-4 text-muted" id="emptyCartMessage">
                    <i class="bi bi-cart-x display-4 d-block mb-2"></i>
                    سلة المشتريات فارغة
                </div>
            </div>
            
            <div class="cart-summary border-top pt-3">
                <div class="d-flex justify-content-between mb-2">
                    <span>المجموع:</span>
                    <span id="cartTotal">0 د.ج</span>
                </div>
                <button class="btn btn-orange w-100" onclick="checkout()" id="checkoutBtn" disabled>
                    <i class="bi bi-bag-check"></i> إتمام الطلب
                </button>
            </div>
        </div>
    </div>

    <!-- نموذج الطلب السريع -->
    <div class="modal fade" id="quickOrderModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">طلب سريع</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="إغلاق"></button>
                </div>
                <div class="modal-body">
                    <div class="order-summary mb-4">
                        <h6 class="mb-3">ملخص الطلب</h6>
                        <div class="d-flex align-items-center">
                            <img id="quickOrderProductImage" class="product-image-thumb me-3" src="" alt="صورة المنتج">
                            <div>
                                <h5 id="quickOrderProductName" class="mb-1"></h5>
                                <p id="quickOrderProductPrice" class="mb-0 text-primary fw-bold"></p>
                            </div>
                        </div>
                    </div>
                    
                    <form id="quickOrderForm">
                        <input type="hidden" id="quickOrderProductId">
                        <input type="hidden" id="quickOrderProductPriceValue">
                        
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="quickOrderFullName" class="form-label">الاسم الكامل <span class="text-danger">*</span></label>
                                <input type="text" class="form-control" id="quickOrderFullName" required>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="quickOrderPhone" class="form-label">رقم الهاتف <span class="text-danger">*</span></label>
                                <input type="tel" class="form-control" id="quickOrderPhone" pattern="[0]{1}[5-7]{1}[0-9]{8}" required>
                                <small class="text-muted">مثال: 0551234566</small>
                            </div>
                        </div>
                        
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="quickOrderEmail" class="form-label">البريد الإلكتروني (اختياري)</label>
                                <input type="email" class="form-control" id="quickOrderEmail">
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="quickOrderWilaya" class="form-label">الولاية <span class="text-danger">*</span></label>
                                <select class="form-select" id="quickOrderWilaya" required>
                                    <option value="">اختر ولايتك</option>
                                </select>
                            </div>
                        </div>
                        
                        <div class="mb-3">
                            <label for="quickOrderAddress" class="form-label">عنوان التوصيل</label>
                            <textarea class="form-control" id="quickOrderAddress" rows="2"></textarea>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">إلغاء</button>
                    <button type="button" class="btn btn-orange" id="submitQuickOrderBtn" onclick="submitQuickOrder()">
                        تأكيد الطلب
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- السكريبتات -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

    <script>
        // تهيئة Firebase
        const firebaseConfig = {
            apiKey: "AIzaSyBTrnKCYOtfSSDYtmVQbzP2HcwgkLT565Y",
            authDomain: "robuste-c8e0f.firebaseapp.com",
            projectId: "robuste-c8e0f",
            storageBucket: "robuste-c8e0f.appspot.com",
            messagingSenderId: "975609984963",
            appId: "1:975609984963:web:a481efb493a88d7bc7af76",
            measurementId: "G-DWT7MZN028"
        };

        // تهيئة Firebase
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();

        // تهيئة EmailJS
        (function() {
            emailjs.init("k77vdaUWPpnLrfTnS");
        })();

        // ============== المتغيرات العامة ==============
        let cart = [];
        let currentProduct = null;
        let relatedProducts = [];

        // ============== إدارة السلة (متوافقة مع main.js) ==============

        // تحميل السلة من localStorage
        function loadCart() {
            try {
                const cartData = localStorage.getItem('robuste_cart');
                if (cartData) {
                    cart = JSON.parse(cartData);
                }
            } catch (e) {
                console.error('خطأ في تحميل سلة المشتريات:', e);
                cart = [];
            }
            updateCartCount();
            renderCart();
        }

        // تحديث عداد السلة
        function updateCartCount() {
            const cartCount = document.getElementById('cartCount');
            const checkoutBtn = document.getElementById('checkoutBtn');
            
            if (!cartCount || !checkoutBtn) return;
            
            const count = cart.reduce((total, item) => total + (item.quantity || 0), 0);
            cartCount.textContent = count;
            checkoutBtn.disabled = count === 0;
        }

        // عرض محتويات السلة
        function renderCart() {
            const cartItems = document.getElementById('cartItems');
            const cartTotal = document.getElementById('cartTotal');
            
            if (!cartItems || !cartTotal) return;
            
            // مسح المحتوى الحالي
            while (cartItems.firstChild) {
                cartItems.removeChild(cartItems.firstChild);
            }
            
            if (cart.length === 0) {
                const emptyDiv = document.createElement('div');
                emptyDiv.className = 'text-center py-4 text-muted';
                emptyDiv.id = 'emptyCartMessage';
                emptyDiv.innerHTML = '<i class="bi bi-cart-x display-4 d-block mb-2"></i>سلة المشتريات فارغة';
                cartItems.appendChild(emptyDiv);
                cartTotal.textContent = '0 د.ج';
                return;
            }
            
            let total = 0;
            cart.forEach((item, index) => {
                const itemTotal = (item.price || 0) * (item.quantity || 0);
                total += itemTotal;
                
                const itemElement = document.createElement('div');
                itemElement.className = 'cart-item';
                itemElement.dataset.id = item.id || '';
                
                itemElement.innerHTML = `
                    <div class="d-flex">
                        <img src="${item.image || ''}" alt="${item.name || 'منتج'}" 
                             style="width: 80px; height: 80px; object-fit: contain; border-radius: 8px; background-color: #f8f8f8; padding: 5px;">
                        <div class="cart-item-details ms-3">
                            <div class="cart-item-title fw-bold">${item.name || 'منتج بدون اسم'}</div>
                            <div class="cart-item-price text-primary fw-bold">${item.price || 0} د.ج</div>
                            <div class="quantity-controls d-flex align-items-center mt-2">
                                <button class="btn btn-sm btn-outline-secondary" onclick="updateCartQuantity(${index}, ${item.quantity - 1})">-</button>
                                <span class="mx-2">${item.quantity || 1}</span>
                                <button class="btn btn-sm btn-outline-secondary" onclick="updateCartQuantity(${index}, ${item.quantity + 1})">+</button>
                                <button class="btn btn-sm btn-outline-danger me-2" onclick="removeFromCart(${index})">
                                    <i class="bi bi-trash"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                `;
                
                cartItems.appendChild(itemElement);
            });
            
            cartTotal.textContent = `${total.toLocaleString('ar-DZ')} د.ج`;
        }

        // تحديث كمية المنتج في السلة
        function updateCartQuantity(index, newQuantity) {
            if (isNaN(index) || index < 0 || index >= cart.length) return;
            
            if (newQuantity < 1) {
                removeFromCart(index);
                return;
            }
            
            cart[index].quantity = newQuantity;
            
            try {
                localStorage.setItem('robuste_cart', JSON.stringify(cart));
            } catch (e) {
                console.error('خطأ في تحديث السلة:', e);
            }
            
            renderCart();
            updateCartCount();
        }

        // إزالة منتج من السلة
        function removeFromCart(index) {
            if (isNaN(index) || index < 0 || index >= cart.length) return;
            
            const productName = cart[index].name || 'منتج';
            cart.splice(index, 1);
            
            try {
                localStorage.setItem('robuste_cart', JSON.stringify(cart));
            } catch (e) {
                console.error('خطأ في تحديث السلة:', e);
            }
            
            renderCart();
            updateCartCount();
            showStatus(`تمت إزالة "${productName}" من السلة`, 'success');
        }

        // إضافة منتج إلى السلة
        function addToCart(productName, productPrice, priceValue, productImages, productId) {
            const name = typeof productName === 'string' ? productName : 'منتج بدون اسم';
            const price = typeof priceValue === 'number' ? priceValue : 
                         typeof productPrice === 'number' ? productPrice : 0;
            const id = productId || Date.now().toString();
            
            let image = '';
            if (Array.isArray(productImages) && productImages.length > 0) {
                image = productImages[0];
            } else if (typeof productImages === 'string') {
                image = productImages;
            }
            
            const existingItemIndex = cart.findIndex(item => item.id === id);
            
            if (existingItemIndex >= 0) {
                cart[existingItemIndex].quantity += 1;
            } else {
                cart.push({
                    id: id,
                    name: name,
                    price: price,
                    image: image,
                    quantity: 1
                });
            }
            
            try {
                localStorage.setItem('robuste_cart', JSON.stringify(cart));
            } catch (e) {
                console.error('خطأ في حفظ السلة:', e);
                showStatus('تعذر حفظ السلة، قد تكون ذاكرة التخزين ممتلئة', 'error');
            }
            
            updateCartCount();
            renderCart();
            
            showStatus(`تمت إضافة "${name}" إلى السلة`, 'success');
        }

        // إظهار/إخفاء السلة
        function toggleCart() {
            if (cart.length === 0) {
                showStatus('سلة المشتريات فارغة', 'info');
                return;
            }
            
            try {
                const cartOffcanvas = new bootstrap.Offcanvas(document.getElementById('cartOffcanvas'));
                cartOffcanvas.show();
            } catch (e) {
                console.error('خطأ في فتح السلة:', e);
                document.getElementById('cartOffcanvas').classList.add('show');
                document.body.classList.add('offcanvas-open');
            }
        }

        // إتمام عملية الشراء
        function checkout() {
            if (cart.length === 0) {
                showStatus('سلة المشتريات فارغة', 'error');
                return;
            }
            
            // إخفاء سلة المشتريات
            const cartOffcanvas = bootstrap.Offcanvas.getInstance(document.getElementById('cartOffcanvas'));
            if (cartOffcanvas) {
                cartOffcanvas.hide();
            }
            
            // توجيه إلى صفحة الطلب في الموقع الرئيسي
            window.location.href = 'index.html';
        }

        // ============== إدارة وضع الظلام ==============

        // تبديل وضع الظلام
        function toggleDarkMode() {
            const currentTheme = document.documentElement.getAttribute('data-theme');
            const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
            
            // تغيير السمة
            document.documentElement.setAttribute('data-theme', newTheme);
            
            // تحديث أيقونة الزر
            const themeIcon = document.querySelector('#themeToggle i');
            if (newTheme === 'dark') {
                themeIcon.className = 'bi bi-sun';
                themeIcon.parentElement.title = 'تفعيل وضع النهار';
            } else {
                themeIcon.className = 'bi bi-moon';
                themeIcon.parentElement.title = 'تفعيل وضع الظلام';
            }
            
            // حفظ التفضيل في localStorage
            localStorage.setItem('theme', newTheme);
        }

        // تهيئة وضع الظلام عند تحميل الصفحة
        function initDarkMode() {
            const savedTheme = localStorage.getItem('theme') || 'light';
            document.documentElement.setAttribute('data-theme', savedTheme);
            
            const themeIcon = document.querySelector('#themeToggle i');
            if (savedTheme === 'dark') {
                themeIcon.className = 'bi bi-sun';
                themeIcon.parentElement.title = 'تفعيل وضع النهار';
            } else {
                themeIcon.className = 'bi bi-moon';
                themeIcon.parentElement.title = 'تفعيل وضع الظلام';
            }
            
            // إضافة مستمع الحدث
            document.getElementById('themeToggle').addEventListener('click', toggleDarkMode);
        }

        // ============== تحميل وعرض المنتج ==============

        // تحميل بيانات المنتج
        async function loadProduct() {
            const urlParams = new URLSearchParams(window.location.search);
            const productId = parseInt(urlParams.get('pid'));
            
            if (!productId) {
                showProductError('لم يتم تحديد معرف المنتج');
                return;
            }
            
            try {
                const response = await fetch('products.json');
                
                if (!response.ok) {
                    throw new Error('خطأ في تحميل المنتجات');
                }
                
                const products = await response.json();
                const product = products.find(p => p.id === productId);
                
                if (!product) {
                    showProductError('المنتج غير موجود');
                    return;
                }
                
                currentProduct = product;
                renderProduct(product);
                loadRelatedProducts(product.category, product.id);
            } catch (error) {
                console.error('خطأ:', error);
                showProductError('خطأ في تحميل المنتج');
            }
        }

        // عرض المنتج
        function renderProduct(product) {
            const container = document.getElementById('productContainer');
            
            if (!container) return;
            
            // حساب نسبة الخصم
            const discountPercentage = product.old_price ? 
                Math.round(((product.old_price - product.price) / product.old_price) * 100) : 0;
            
            // إنشاء معرض الصور المصغرة
            const thumbnails = product.images.map((img, index) => `
                <div class="thumbnail ${index === 0 ? 'active' : ''}" onclick="changeMainImage('${img}', this)">
                    <img src="${img}" alt="صورة ${index + 1}" loading="lazy">
                </div>
            `).join('');
            
            // إنشاء قائمة المميزات
            const featuresList = product.features ? product.features.map(feature => `
                <li>${feature}</li>
            `).join('') : '';
            
            container.innerHTML = `
                <div class="product-gallery">
                    <div class="main-image-container">
                        <img src="${product.images[0]}" alt="${product.title}" id="mainProductImage" class="main-image">
                    </div>
                    <div class="thumbnail-container">
                        ${thumbnails}
                    </div>
                </div>
                
                <div class="product-details">
                    <h1 class="product-title">${product.title}</h1>
                    
                    <div class="product-rating">
                        <div class="stars">
                            <i class="bi bi-star-fill"></i>
                            <i class="bi bi-star-fill"></i>
                            <i class="bi bi-star-fill"></i>
                            <i class="bi bi-star-fill"></i>
                            <i class="bi bi-star-half"></i>
                        </div>
                        <span class="rating-count">(4.2) · 128 تقييم</span>
                    </div>
                    
                    <div class="price-section">
                        ${product.old_price ? `
                            <span class="discount-badge">-${discountPercentage}%</span>
                            <span class="old-price">${product.old_price.toLocaleString()} د.ج</span>
                        ` : ''}
                        <div class="current-price">${product.price.toLocaleString()} د.ج</div>
                    </div>
                    
                    <p class="product-description">${product.description || product.description_short || ''}</p>
                    
                    ${featuresList ? `
                    <div class="features-list">
                        <h5>المميزات:</h5>
                        <ul>
                            ${featuresList}
                        </ul>
                    </div>
                    ` : ''}
                    
                    <div class="stock-status ${product.stock > 0 ? 'in-stock' : 'out-of-stock'}">
                        <i class="bi ${product.stock > 0 ? 'bi-check-circle-fill' : 'bi-x-circle-fill'}"></i>
                        <span>${product.stock > 0 ? `متوفر في المخزون (${product.stock} قطعة)` : 'نفذ من المخزون'}</span>
                    </div>
                    
                    <div class="action-buttons">
                        <button class="btn-amazon" onclick="addToCartFromPage()">
                            <i class="bi bi-cart-plus"></i> أضف إلى السلة
                        </button>
                        <button class="btn-amazon btn-amazon-primary" onclick="openQuickOrder()">
                            <i class="bi bi-lightning"></i> اشترِ الآن
                        </button>
                    </div>
                    
                    <div class="shipping-info">
                        <div class="item">
                            <i class="bi bi-truck"></i>
                            <span>توصيل مجاني للطلبات فوق 5000 د.ج</span>
                        </div>
                        <div class="item">
                            <i class="bi bi-shield-check"></i>
                            <span>ضمان لمدة سنتين</span>
                        </div>
                        <div class="item">
                            <i class="bi bi-arrow-clockwise"></i>
                            <span>إرجاع سهل خلال 14 يوم</span>
                        </div>
                    </div>
                </div>
            `;
        }

        // تغيير الصورة الرئيسية
        function changeMainImage(src, element) {
            document.getElementById('mainProductImage').src = src;
            
            // إزالة النشط من جميع الصور المصغرة
            document.querySelectorAll('.thumbnail').forEach(thumb => {
                thumb.classList.remove('active');
            });
            
            // إضافة النشط للصورة المحددة
            element.classList.add('active');
        }

        // إضافة المنتج الحالي إلى السلة
        function addToCartFromPage() {
            if (!currentProduct) return;
            
            addToCart(
                currentProduct.title,
                `${currentProduct.price.toLocaleString()} د.ج`,
                currentProduct.price,
                currentProduct.images,
                currentProduct.id
            );
        }

        // ============== المنتجات المشابهة ==============

        // تحميل المنتجات المشابهة
        async function loadRelatedProducts(category, currentProductId) {
            try {
                const response = await fetch('products.json');
                const products = await response.json();
                
                // تصفية المنتجات بنفس الفئة عدا المنتج الحالي
                relatedProducts = products.filter(p => 
                    p.category === category && p.id !== currentProductId
                ).slice(0, 4); // أخذ أول 4 منتجات
                
                renderRelatedProducts();
            } catch (error) {
                console.error('خطأ في تحميل المنتجات المشابهة:', error);
            }
        }

        // عرض المنتجات المشابهة
        function renderRelatedProducts() {
            const container = document.getElementById('relatedProductsContainer');
            
            if (!container) return;
            
            if (relatedProducts.length === 0) {
                container.innerHTML = '<p class="text-center text-muted">لا توجد منتجات مشابهة</p>';
                return;
            }
            
            container.innerHTML = relatedProducts.map(product => {
                const discountBadge = product.old_price && product.old_price > product.price ? 
                    `<span class="badge bg-danger position-absolute" style="top: 10px; right: 10px;">
                        -${Math.round(((product.old_price - product.price) / product.old_price) * 100)}%
                    </span>` : '';
                
                const oldPrice = product.old_price && product.old_price > product.price ? 
                    `<div class="product-card-old-price">${product.old_price.toLocaleString()} د.ج</div>` : '';
                
                return `
                    <div class="product-card">
                        ${discountBadge}
                        <a href="product.html?pid=${product.id}" style="text-decoration: none; color: inherit;">
                            <div class="product-card-image">
                                <img src="${product.images[0]}" alt="${product.title}" loading="lazy">
                            </div>
                            <div class="product-card-content">
                                <h6 class="product-card-title">${product.title}</h6>
                                <div class="d-flex align-items-center mt-auto">
                                    <div class="product-card-price">${product.price.toLocaleString()} د.ج</div>
                                    ${oldPrice}
                                </div>
                            </div>
                        </a>
                        <button class="product-card-btn" onclick="event.stopPropagation(); addRelatedToCart(${product.id})">
                            <i class="bi bi-cart-plus"></i> أضف إلى السلة
                        </button>
                    </div>
                `;
            }).join('');
        }

        // إضافة منتج مشابه إلى السلة
        function addRelatedToCart(productId) {
            const product = relatedProducts.find(p => p.id === productId);
            
            if (product) {
                addToCart(
                    product.title,
                    `${product.price.toLocaleString()} د.ج`,
                    product.price,
                    product.images,
                    product.id
                );
            }
        }

        // ============== الطلب السريع ==============

        // فتح نموذج الطلب السريع
        function openQuickOrder() {
            if (!currentProduct) return;
            
            document.getElementById('quickOrderProductName').textContent = currentProduct.title;
            document.getElementById('quickOrderProductPrice').textContent = currentProduct.price.toLocaleString() + ' د.ج';
            document.getElementById('quickOrderProductImage').src = currentProduct.images[0];
            document.getElementById('quickOrderProductId').value = currentProduct.id;
            document.getElementById('quickOrderProductPriceValue').value = currentProduct.price;
            
            // تعبئة قائمة الولايات
            populateWilayas();
            
            const quickOrderModal = new bootstrap.Modal(document.getElementById('quickOrderModal'));
            quickOrderModal.show();
        }

        // تعبئة قائمة الولايات الجزائرية
        function populateWilayas() {
            const wilayas = [
                "أدرار", "الشلف", "الأغواط", "أم البواقي", "باتنة", "بجاية", "بسكرة", "بشار", "البليدة",
                "البويرة", "تمنراست", "تبسة", "تلمسان", "تيارت", "تيزي وزو", "الجزائر", "الجلفة", "جيجل",
                "سطيف", "سعيدة", "سكيكدة", "سيدي بلعباس", "عنابة", "قالمة", "قسنطينة", "المدية", "مستغانم",
                "المسيلة", "معسكر", "ورقلة", "وهران", "البيض", "إليزي", "برج بوعريريج", "بومرداس", "الطارف",
                "تيندوف", "تيسمسيلت", "الوادي", "خنشلة", "سوق أهراس", "تيبازة", "ميلة", "عين الدفلى", "النعامة",
                "عين تموشنت", "غرداية", "غليزان"
            ];
            
            const wilayaSelect = document.getElementById('quickOrderWilaya');
            wilayaSelect.innerHTML = '<option value="">اختر ولايتك</option>';
            
            wilayas.forEach(wilaya => {
                const option = document.createElement('option');
                option.value = wilaya;
                option.textContent = wilaya;
                wilayaSelect.appendChild(option);
            });
        }

        // إرسال الطلب السريع
        async function submitQuickOrder() {
            const fullName = document.getElementById('quickOrderFullName').value;
            const phone = document.getElementById('quickOrderPhone').value;
            const email = document.getElementById('quickOrderEmail').value || 'لم يتم تقديمه';
            const wilaya = document.getElementById('quickOrderWilaya').value;
            const address = document.getElementById('quickOrderAddress').value || 'غير محدد';
            const productId = document.getElementById('quickOrderProductId').value;
            const productPrice = parseFloat(document.getElementById('quickOrderProductPriceValue').value);
            
            // التحقق من صحة البيانات
            if (!fullName || !phone || !wilaya) {
                showStatus('الرجاء ملء جميع الحقول المطلوبة', 'error');
                return;
            }
            
            const phoneRegex = /^0[5-7][0-9]{8}$/;
            if (!phoneRegex.test(phone)) {
                showStatus('رقم الهاتف غير صحيح. يجب أن يتكون من 10 أرقام ويبدأ بـ 05 أو 06 أو 07', 'error');
                return;
            }
            
            // إنشاء كائن المنتج للطلب
            const productItem = {
                id: productId,
                name: document.getElementById('quickOrderProductName').textContent,
                price: productPrice,
                image: document.getElementById('quickOrderProductImage').src,
                quantity: 1
            };
            
            // إعداد بيانات الطلب
            const orderData = {
                products: [productItem],
                customer: fullName,
                phone: phone,
                email: email,
                wilaya: wilaya,
                address: address,
                payment: 'الدفع عند الاستلام',
                totalPrice: productPrice,
                timestamp: new Date().toISOString(),
                status: 'جديد'
            };
            
            // عرض حالة التحميل
            showStatus('جاري معالجة طلبك...', 'loading');
            
            // تعطيل زر الإرسال أثناء المعالجة
            const submitBtn = document.getElementById('submitQuickOrderBtn');
            submitBtn.disabled = true;
            submitBtn.innerHTML = `
                <span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>
                جاري المعالجة...
            `;
            
            try {
                // تخزين الطلب في Firebase
                const docRef = await db.collection('orders').add(orderData);
                console.log("تم تخزين الطلب في Firebase:", docRef.id);
                
                // إرسال إيميل عبر EmailJS
                await emailjs.send("service_lc1q5k8", "template_a15g7yg", {
                    order_id: docRef.id,
                    customer_name: fullName,
                    customer_phone: phone,
                    customer_email: email,
                    wilaya: wilaya,
                    address: address,
                    total_price: productPrice.toLocaleString(),
                    payment_method: 'الدفع عند الاستلام',
                    order_date: new Date().toLocaleString('ar-DZ'),
                    product_name: productItem.name
                });
                
                console.log("تم إرسال إيميل تأكيد الطلب");
                
                // عرض رسالة النجاح
                showStatus(`
                    <div class="text-center">
                        <i class="bi bi-check-circle-fill text-success fs-1"></i>
                        <h5 class="mt-2">تم تأكيد طلبك بنجاح!</h5>
                        <div class="text-start mt-3">
                            <p><strong>رقم الطلب:</strong> ${docRef.id}</p>
                            <p><strong>الاسم:</strong> ${fullName}</p>
                            <p><strong>المنتج:</strong> ${productItem.name}</p>
                            <p><strong>المبلغ:</strong> ${productPrice.toLocaleString()} د.ج</p>
                            <p class="mt-3">سيتم التواصل معك على الرقم <strong>${phone}</strong> خلال 24 ساعة لتأكيد الشحن.</p>
                        </div>
                    </div>
                `, 'success');
                
                // إغلاق النموذج وإعادة تعيينه
                const quickOrderModal = bootstrap.Modal.getInstance(document.getElementById('quickOrderModal'));
                quickOrderModal.hide();
                document.getElementById('quickOrderForm').reset();
                
                // إضافة المنتج إلى السلة
                addToCartFromPage();
                
            } catch (error) {
                console.error('حدث خطأ:', error);
                
                let errorMessage = 'حدث خطأ غير متوقع. يرجى المحاولة مرة أخرى.';
                if (error.code) {
                    errorMessage = `خطأ في النظام: ${error.code}`;
                } else if (error.message) {
                    errorMessage = error.message;
                } else if (error.text) {
                    errorMessage = error.text;
                }
                
                showStatus(`حدث خطأ أثناء إرسال الطلب: ${errorMessage}`, 'error');
            } finally {
                // إعادة تمكين زر الإرسال
                submitBtn.disabled = false;
                submitBtn.innerHTML = 'تأكيد الطلب';
            }
        }

        // ============== وظائف مساعدة ==============

        // عرض خطأ المنتج
        function showProductError(message) {
            const container = document.getElementById('productContainer');
            container.innerHTML = `
                <div class="col-12 text-center py-5">
                    <i class="bi bi-exclamation-triangle display-1 text-danger"></i>
                    <h3 class="mt-3">${message}</h3>
                    <p class="mb-4">نعتذر، لم نتمكن من العثور على المنتج المطلوب.</p>
                    <a href="index.html" class="btn btn-orange btn-lg">
                        <i class="bi bi-arrow-left"></i> العودة إلى المتجر
                    </a>
                </div>
            `;
        }

        // عرض حالة الطلب
        function showStatus(message, type) {
            const indicator = document.getElementById('statusIndicator');
            const messageElement = document.getElementById('statusMessage');
            
            // إعداد الرسالة
            messageElement.innerHTML = message;
            
            // إعداد التصميم حسب النوع
            const alert = indicator.querySelector('.alert');
            alert.className = 'alert alert-dismissible fade show';
            
            switch (type) {
                case 'success':
                    alert.classList.add('alert-success', 'order-confirmation');
                    break;
                case 'error':
                    alert.classList.add('alert-danger', 'order-error');
                    break;
                case 'info':
                    alert.classList.add('alert-info');
                    break;
                case 'loading':
                    alert.classList.add('alert-info');
                    messageElement.innerHTML = `
                        <span class="spinner-border spinner-border-sm me-2" role="status"></span>
                        ${message}
                    `;
                    break;
                default:
                    alert.classList.add('alert-info');
            }
            
            // إظهار المؤشر
            indicator.style.display = 'block';
            
            // إخفاء التلقائي لرسائل النجاح بعد 5 ثواني
            if (type === 'success') {
                setTimeout(hideStatus, 5000);
            }
        }

        // إخفاء مؤشر الحالة
        function hideStatus() {
            document.getElementById('statusIndicator').style.display = 'none';
        }

        // ============== تهيئة الصفحة ==============
        document.addEventListener('DOMContentLoaded', function() {
            // تهيئة وضع الظلام
            initDarkMode();
            
            // تحميل السلة
            loadCart();
            
            // تحميل المنتج
            loadProduct();
            
            // إضافة معالجة الروابط في البطاقات لمنع الانتقال عند النقر على الأزرار
            document.addEventListener('click', function(e) {
                if (e.target.closest('.product-card-btn') || 
                    e.target.closest('.action-buttons button')) {
                    e.preventDefault();
                    e.stopPropagation();
                }
            });
        });
    </script>
</body>
</html>
