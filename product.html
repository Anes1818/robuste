<!DOCTYPE html>
<html dir="rtl" lang="fr">
<head>
<meta name="description" content="Robuste eulma - Découvrez nos produits électroménagers de haute qualité avec garantie et livraison rapide en Algérie">
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">

<!-- Favicon -->
<link rel="shortcut icon" href="images/favicon.ico" type="image/x-icon">
<link rel="apple-touch-icon" sizes="180x180" href="images/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="images/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="images/favicon-16x16.png">

<!-- Theme color -->
<meta name="theme-color" content="#ff6600">
<title>Robuste eulma - Produit</title>

<!-- Google Fonts -->
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700;800&display=swap" rel="stylesheet">

<!-- Bootstrap RTL -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.rtl.min.css" rel="stylesheet">

<!-- Bootstrap Icons -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">

<!-- EmailJS -->
<script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>

<style>
:root {
    --primary: #FF6B35;
    --primary-dark: #E05A2B;
    --secondary: #FFF8F0;
    --light: #FFFFFF;
    --dark: #333333;
    --gray: #6C757D;
    --success: #28a745;
    --danger: #dc3545;
    --gradient: linear-gradient(135deg, #FF6B35 0%, #FF8E53 100%);
    --amazon-bg: #EAEDED;
    --amazon-border: #DDD;
    --amazon-text: #0F1111;
    --amazon-price: #B12704;
}

body {
    font-family: 'Tajawal', sans-serif;
    background-color: var(--amazon-bg);
    color: var(--amazon-text);
    padding-top: 56px;
}

.navbar {
    background-color: var(--light);
    box-shadow: 0 2px 15px rgba(0, 0, 0, 0.1);
    transition: all 0.3s ease;
}

.navbar-brand {
    color: var(--primary) !important;
    font-weight: 700;
    font-size: 1.5rem;
}

/* Amazon-style product page */
.product-page {
    padding: 40px 0;
    background-color: var(--amazon-bg);
}

.product-container {
    display: flex;
    gap: 20px;
    margin-bottom: 40px;
}

.product-gallery {
    flex: 1;
    background: white;
    border-radius: 8px;
    padding: 20px;
    box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    border: 1px solid var(--amazon-border);
}

.main-image {
    border-radius: 8px;
    overflow: hidden;
    margin-bottom: 15px;
    background: white;
    display: flex;
    align-items: center;
    justify-content: center;
    height: 450px;
    border: 1px solid var(--amazon-border);
}

.main-image img {
    max-width: 100%;
    max-height: 100%;
    object-fit: contain;
}

.thumbnails {
    display: flex;
    gap: 12px;
    overflow-x: auto;
    padding: 15px 0;
}

.thumbnail {
    width: 80px;
    height: 80px;
    border-radius: 4px;
    overflow: hidden;
    cursor: pointer;
    border: 2px solid transparent;
    transition: all 0.3s ease;
    flex-shrink: 0;
    border: 1px solid var(--amazon-border);
}

.thumbnail.active {
    border-color: var(--primary);
}

.thumbnail img {
    width: 100%;
    height: 100%;
    object-fit: cover;
}

.product-info {
    flex: 1;
    background: white;
    border-radius: 8px;
    padding: 20px;
    box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    border: 1px solid var(--amazon-border);
}

.product-title {
    font-size: 1.5rem;
    font-weight: 700;
    margin-bottom: 10px;
    color: var(--amazon-text);
}

.rating {
    display: flex;
    align-items: center;
    margin-bottom: 15px;
}

.stars {
    color: #FFA41C;
    margin-left: 10px;
    font-size: 1rem;
}

.rating-text {
    color: var(--gray);
    font-size: 0.9rem;
}

.price-section {
    margin-bottom: 20px;
    padding-bottom: 15px;
    border-bottom: 1px solid var(--amazon-border);
}

.current-price {
    font-size: 1.8rem;
    font-weight: 700;
    color: var(--amazon-price);
    margin-left: 10px;
}

.old-price {
    font-size: 1.2rem;
    color: var(--gray);
    text-decoration: line-through;
}

.discount {
    background: var(--danger);
    color: white;
    padding: 4px 8px;
    border-radius: 4px;
    font-size: 0.9rem;
    font-weight: 700;
    margin-right: 10px;
}

.features-list {
    margin: 20px 0;
}

.features-list li {
    margin-bottom: 8px;
    padding-right: 25px;
    position: relative;
    font-size: 1rem;
    line-height: 1.5;
}

.features-list li:before {
    content: "✓";
    position: absolute;
    right: 0;
    color: var(--success);
    font-weight: bold;
}

.stock-info {
    display: flex;
    align-items: center;
    margin-bottom: 20px;
    color: var(--success);
    font-weight: 700;
}

.stock-info i {
    margin-left: 10px;
    font-size: 1.2rem;
}

.action-buttons {
    display: flex;
    gap: 10px;
    margin-top: 25px;
}

.btn-orange {
    background: var(--gradient);
    color: white;
    border: none;
    padding: 12px 20px;
    border-radius: 20px;
    font-weight: 700;
    font-size: 1rem;
    transition: all 0.3s;
    flex: 1;
}

.btn-orange:hover {
    background: var(--primary-dark);
    transform: translateY(-2px);
}

.btn-outline-orange {
    border: 2px solid var(--primary);
    color: var(--primary);
    background: transparent;
    padding: 12px 20px;
    border-radius: 20px;
    font-weight: 700;
    font-size: 1rem;
    transition: all 0.3s;
    flex: 1;
}

.btn-outline-orange:hover {
    background: var(--gradient);
    color: white;
}

.shipping-info {
    margin-top: 25px;
    padding: 15px;
    background: #F8F9FA;
    border-radius: 8px;
    border: 1px solid var(--amazon-border);
}

.shipping-info .item {
    display: flex;
    align-items: center;
    margin-bottom: 10px;
}

.shipping-info .item i {
    margin-left: 10px;
    color: var(--primary);
    font-size: 1.2rem;
}

.product-details {
    background: white;
    border-radius: 8px;
    padding: 20px;
    box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    border: 1px solid var(--amazon-border);
}

.details-tabs {
    border-bottom: 2px solid var(--amazon-border);
    margin-bottom: 20px;
}

.details-tabs .nav-link {
    border: none;
    color: var(--gray);
    font-weight: 700;
    padding: 10px 20px;
    font-size: 1rem;
    transition: all 0.3s;
    position: relative;
}

.details-tabs .nav-link.active {
    color: var(--primary);
    background: transparent;
}

.details-tabs .nav-link.active:after {
    content: '';
    position: absolute;
    bottom: -2px;
    right: 0;
    width: 100%;
    height: 3px;
    background: var(--gradient);
}

.description-content {
    line-height: 1.6;
    font-size: 1rem;
    color: #555;
}

.features-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 20px;
    margin-top: 20px;
}

.feature-card {
    background: #F8F9FA;
    padding: 20px;
    border-radius: 8px;
    text-align: center;
    transition: all 0.3s ease;
    border: 1px solid var(--amazon-border);
}

.feature-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 5px 15px rgba(0,0,0,0.1);
}

.feature-card i {
    font-size: 2rem;
    color: var(--primary);
    margin-bottom: 15px;
}

/* Related products section - FIXED */
.related-products {
    margin-top: 40px;
    padding: 40px 0;
    background: white;
    border-radius: 8px;
    box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    border: 1px solid var(--amazon-border);
}

.section-title {
    text-align: center;
    font-size: 1.8rem;
    font-weight: 700;
    margin-bottom: 30px;
    color: var(--amazon-text);
}

.products-slider {
    position: relative;
    overflow: hidden;
}

.products-track {
    display: flex;
    gap: 20px;
    transition: transform 0.5s ease;
    padding: 10px 0;
    overflow-x: auto;
    scroll-behavior: smooth;
    -webkit-overflow-scrolling: touch;
    scrollbar-width: thin;
    scrollbar-color: var(--primary) #f1f1f1;
}

.products-track::-webkit-scrollbar {
    height: 8px;
}

.products-track::-webkit-scrollbar-track {
    background: #f1f1f1;
    border-radius: 10px;
}

.products-track::-webkit-scrollbar-thumb {
    background: var(--primary);
    border-radius: 10px;
}

.product-slide {
    flex: 0 0 250px;
    background: white;
    border-radius: 8px;
    overflow: hidden;
    box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    transition: all 0.3s ease;
    border: 1px solid var(--amazon-border);
}

.product-slide:hover {
    transform: translateY(-5px);
    box-shadow: 0 5px 15px rgba(0,0,0,0.1);
}

.product-slide img {
    width: 100%;
    height: 180px;
    object-fit: cover;
}

.product-slide-content {
    padding: 15px;
}

.slide-nav {
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
    background: white;
    border: none;
    width: 40px;
    height: 40px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    box-shadow: 0 2px 5px rgba(0,0,0,0.2);
    z-index: 10;
    transition: all 0.3s;
    font-size: 1rem;
    color: var(--primary);
}

.slide-nav:hover {
    background: var(--primary);
    color: white;
}

.slide-prev {
    right: -20px;
}

.slide-next {
    left: -20px;
}

/* Order modal */
.order-modal .modal-content {
    border-radius: 8px;
    border: none;
    box-shadow: 0 5px 15px rgba(0,0,0,0.2);
}

.order-modal .modal-header {
    background: var(--gradient);
    color: white;
    border-bottom: none;
    padding: 15px 20px;
}

.order-modal .modal-title {
    font-weight: 700;
    font-size: 1.3rem;
}

.order-modal .modal-body {
    padding: 20px;
}

.order-summary-card {
    background: #F8F9FA;
    border-radius: 8px;
    padding: 15px;
    margin-bottom: 20px;
    border: 1px solid var(--amazon-border);
}

.form-floating {
    margin-bottom: 15px;
}

.form-floating label {
    color: #666;
    font-weight: 500;
}

.form-control, .form-select {
    border-radius: 8px;
    border: 1px solid var(--amazon-border);
    padding: 12px;
    font-size: 1rem;
    transition: all 0.3s;
}

.form-control:focus, .form-select:focus {
    border-color: var(--primary);
    box-shadow: 0 0 0 0.2rem rgba(255, 107, 53, 0.25);
}

.payment-methods {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
    gap: 10px;
    margin: 20px 0;
}

.payment-method {
    border: 1px solid var(--amazon-border);
    border-radius: 8px;
    padding: 10px;
    text-align: center;
    cursor: pointer;
    transition: all 0.3s;
    background: white;
}

.payment-method:hover {
    border-color: var(--primary);
}

.payment-method.active {
    border-color: var(--primary);
    background: rgba(255, 107, 53, 0.05);
}

.payment-method i {
    font-size: 1.5rem;
    margin-bottom: 8px;
    color: var(--primary);
}

/* Mobile improvements */
@media (max-width: 768px) {
    .product-container {
        flex-direction: column;
    }
    
    .main-image {
        height: 300px;
    }
    
    .product-title {
        font-size: 1.3rem;
    }
    
    .current-price {
        font-size: 1.5rem;
    }
    
    .action-buttons {
        flex-direction: column;
    }
    
    .slide-nav {
        display: none;
    }
    
    .products-track {
        gap: 15px;
        padding: 5px;
    }
    
    .product-slide {
        flex: 0 0 220px;
    }
}

/* Cart and alerts */
.whatsapp-btn {
    position: fixed;
    bottom: 20px;
    left: 20px;
    z-index: 1000;
    width: 50px;
    height: 50px;
    border-radius: 50%;
    background: linear-gradient(135deg, #25D366 0%, #128C7E 100%);
    color: white;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 24px;
    box-shadow: 0 4px 10px rgba(37, 211, 102, 0.4);
    transition: all 0.3s;
}

.whatsapp-btn:hover {
    transform: scale(1.1);
}

.status-indicator {
    position: fixed;
    top: 20px;
    right: 20px;
    z-index: 2000;
    max-width: 350px;
}

.spinner-border {
    width: 1.2rem;
    height: 1.2rem;
    border-width: 0.15em;
}

.order-confirmation {
    background-color: rgba(255, 255, 255, 0.95);
    border-left: 4px solid var(--success);
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
    border-radius: 8px;
}

.order-error {
    background-color: rgba(255, 255, 255, 0.95);
    border-left: 4px solid var(--danger);
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
    border-radius: 8px;
}

.cart-icon-container {
    position: fixed;
    top: 70px;
    left: 20px;
    z-index: 1000;
    display: flex;
    flex-direction: column;
    align-items: center;
}

.cart-btn {
    width: 50px;
    height: 50px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    background: var(--gradient);
    color: white;
    border: none;
    box-shadow: 0 4px 10px rgba(255, 107, 53, 0.4);
    transition: all 0.3s ease;
    text-decoration: none;
    position: relative;
}

.cart-btn:hover {
    transform: scale(1.1);
}

.cart-btn i {
    font-size: 1.3rem;
}

#cartCount {
    position: absolute;
    top: -5px;
    right: -5px;
    background: var(--danger);
    color: white;
    border-radius: 50%;
    width: 20px;
    height: 20px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 0.7rem;
    font-weight: bold;
    border: 2px solid white;
}

.language-switcher {
    display: flex;
    gap: 5px;
}

/* Entrance effects */
.fade-in {
    animation: fadeIn 0.5s ease-in;
}

.slide-in-up {
    animation: slideInUp 0.5s ease-out;
}

@keyframes fadeIn {
    from { opacity: 0; }
    to { opacity: 1; }
}

@keyframes slideInUp {
    from { 
        opacity: 0;
        transform: translateY(20px);
    }
    to { 
        opacity: 1;
        transform: translateY(0);
    }
}
</style>
</head>

<body>
    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg navbar-light fixed-top bg-white shadow-sm">
        <div class="container">
            <a class="navbar-brand" href="index.html">
                <img src="https://i.postimg.cc/7P7BK44r/f525e1dd-9f2c-4160-aed1-882a8b28b75c-20250703-131500-0000.png" 
                     alt="Robuste Logo" class="d-inline-block align-top" 
                     style="width: 150px; height: auto; max-height: 40px; object-fit:fill;">
                <span class="d-none d-lg-inline fw-bold fs-4 ms-2" style="color: #FF6B35;">ROBUSTE eulma</span>
            </a>
            
            <!-- Language switcher -->
            <div class="language-switcher me-3">
                <a href="ar/product.html" class="btn btn-sm btn-outline-secondary">العربية</a>
            </div>
            
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav me-auto">
                    <li class="nav-item mx-2"><a class="nav-link" href="index.html">Accueil</a></li>
                    <li class="nav-item"><a class="nav-link" href="index.html#products">Produits</a></li>
                    <li class="nav-item"><a class="nav-link" href="index.html#reviews">Avis clients</a></li>
                    <li class="nav-item"><a class="nav-link" href="index.html#contact">Contactez-nous</a></li>
                </ul>
            </div>
            
            <!-- Cart icon with counter -->
            <div class="cart-icon-container ms-lg-4">
                <span class="cart-label d-none d-lg-inline">panier</span>
                <a href="#" class="cart-btn position-relative" onclick="toggleCart(); return false;">
                    <i class="bi bi-cart3"></i>
                    <span class="position-absolute badge rounded-pill bg-danger" id="cartCount">0</span>
                </a>
            </div>
        </div>
    </nav>

    <!-- Status indicator -->
    <div class="status-indicator" id="statusIndicator" style="display: none;">
        <div class="alert alert-dismissible fade show" role="alert">
            <span id="statusMessage"></span>
            <button type="button" class="btn-close" onclick="hideStatus()"></button>
        </div>
    </div>

    <!-- Product page content -->
    <div class="container product-page">
        <div class="product-container" id="productContainer">
            <!-- This section will be filled with dynamic data -->
            <div class="text-center py-5 w-100">
                <div class="spinner-border text-primary" role="status">
                    <span class="visually-hidden">Chargement...</span>
                </div>
                <p class="mt-3">Chargement du produit...</p>
            </div>
        </div>
    </div>

    <!-- Related products section -->
    <section class="related-products">
        <div class="container">
            <h2 class="section-title">Produits Similaires</h2>
            <div class="products-slider">
                <button class="slide-nav slide-prev" onclick="slideProducts(-1)">
                    <i class="bi bi-chevron-right"></i>
                </button>
                <button class="slide-nav slide-next" onclick="slideProducts(1)">
                    <i class="bi bi-chevron-left"></i>
                </button>
                <div class="products-track" id="productsTrack">
                    <!-- This section will be filled with suggested products -->
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="py-5 bg-dark text-white">
        <div class="container">
            <div class="row">
                <div class="col-lg-4 mb-4">
                    <h5 class="mb-3">À propos de ROBUSTE</h5>
                    <p>Magasin spécialisé dans l'électroménager de haute qualité à prix compétitifs. Nous proposons les meilleurs produits et une livraison rapide.</p>
                    <div class="mt-3">
                        <a href="https://www.facebook.com/share/19QooaXfy8/" class="social-icon"><i class="bi bi-facebook"></i> </a>
                    </div>
                </div>
                <div class="col-lg-2 col-md-4 mb-4">
                    <h5 class="mb-3">Liens rapides</h5>
                    <ul class="list-unstyled">
                        <li class="mb-2"><a href="index.html" class="text-white text-decoration-none">Accueil</a></li>
                        <li class="mb-2"><a href="index.html#products" class="text-white text-decoration-none">Produits</a></li>
                        <li class="mb-2"><a href="index.html#reviews" class="text-white text-decoration-none">Avis clients</a></li>
                        <li class="mb-2"><a href="index.html#contact" class="text-white text-decoration-none">Contactez-nous</a></li>
                    </ul>
                </div>
                <div class="col-lg-3 col-md-4 mb-4">
                    <h5 class="mb-3">Service client</h5>
                    <ul class="list-unstyled">
                        <li class="mb-2"><a href="#" class="text-white text-decoration-none">FAQ</a></li>
                        <li class="mb-2"><a href="#" class="text-white text-decoration-none">Modes de paiement</a></li>
                        <li class="mb-2"><a href="#" class="text-white text-decoration-none">Conditions de garantie</a></li>
                    </ul>
                </div>
                <div class="col-lg-3 col-md-4 mb-4">
                    <h5 class="mb-3">Abonnez-vous à notre page</h5>
                    <p>Abonnez-vous pour recevoir les dernières offres</p>
                    <div class="mt-3">
                        <a href="https://www.facebook.com/share/19QooaXfy8/" class="btn btn-orange w-100" target="_blank">S'abonner</a>
                    </div>
                </div>
            </div>
            <hr class="my-4 bg-light">
            <div class="row">
                <div class="col-md-6 text-center text-md-start mb-3 mb-md-0">
                    <p class="mb-0">&copy; 2025 ROBUSTE. Tous droits réservés.</p>
                </div>
                <div class="col-md-6 text-center text-md-end">
                    <div class="d-flex flex-column flex-md-row align-items-center justify-content-md-end">
                        <p class="mb-2 mb-md-0 me-md-3">Paiement par carte gold disponible</p>
                        <img src="https://i.postimg.cc/bY06X2YN/logo-round.png" alt="Modes de paiement" style="width: 30px; height: auto;">
                    </div>
                </div>
            </div>
        </div>
    </footer>

    <!-- WhatsApp button -->
    <a href="https://wa.me/213656360457" class="whatsapp-btn" target="_blank">
        <i class="bi bi-whatsapp"></i>
    </a>

    <!-- Shopping cart -->
    <div class="offcanvas offcanvas-end" tabindex="-1" id="cartOffcanvas" aria-labelledby="cartOffcanvasLabel">
        <div class="offcanvas-header">
            <h5 class="offcanvas-title" id="cartOffcanvasLabel">Panier d'achat</h5>
            <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>
        </div>
        <div class="offcanvas-body">
            <div id="cartItems" class="mb-3">
                <div class="text-center py-4 text-muted" id="emptyCartMessage">
                    <i class="bi bi-cart-x display-4 d-block mb-2"></i>
                    Panier d'achat فارغة
                </div>
            </div>
            
            <div class="cart-summary border-top pt-3">
                <div class="d-flex justify-content-between mb-2">
                    <span>Total:</span>
                    <span id="cartTotal">0 د.ج</span>
                </div>
                <button class="btn btn-orange w-100" onclick="checkout()" id="checkoutBtn" disabled>
                    <i class="bi bi-bag-check"></i> Finaliser la commande
                </button>
            </div>
        </div>
    </div>

    <!-- Quick order modal -->
    <div class="modal fade order-modal" id="orderModal" tabindex="-1" aria-labelledby="orderModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="orderModalLabel">Commande Rapide</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="order-summary-card">
                        <h6 class="mb-3">Résumé de la commande</h6>
                        <div class="d-flex align-items-center">
                            <img id="orderProductImage" class="product-image-thumb me-3" src="" alt="Produit" style="width: 80px; height: 80px; object-fit: cover; border-radius: 8px;">
                            <div>
                                <h5 id="orderProductName" class="mb-1"></h5>
                                <p id="orderProductPrice" class="mb-0 text-primary fw-bold"></p>
                            </div>
                        </div>
                    </div>
                    
                    <form id="quickOrderForm">
                        <div class="row">
                            <div class="col-md-6">
                                <div class="form-floating">
                                    <input type="text" class="form-control" id="quickFullName" placeholder="Nom complet" required>
                                    <label for="quickFullName">Nom complet *</label>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-floating">
                                    <input type="tel" class="form-control" id="quickPhone" placeholder="Téléphone" pattern="[0]{1}[5-7]{1}[0-9]{8}" required>
                                    <label for="quickPhone">Numéro de téléphone *</label>
                                </div>
                            </div>
                        </div>
                        
                        <div class="row mt-3">
                            <div class="col-md-6">
                                <div class="form-floating">
                                    <input type="email" class="form-control" id="quickEmail" placeholder="Email">
                                    <label for="quickEmail">Email (optionnel)</label>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-floating">
                                    <select class="form-select" id="quickWilaya" required>
                                        <option value="">Sélectionnez votre wilaya</option>
                                    </select>
                                    <label for="quickWilaya">Wilaya *</label>
                                </div>
                            </div>
                        </div>
                        
                        <div class="form-floating mt-3">
                            <textarea class="form-control" id="quickAddress" placeholder="Adresse" style="height: 100px"></textarea>
                            <label for="quickAddress">Adresse de livraison</label>
                        </div>
                        
                        <div class="payment-methods mt-4">
                            <div class="payment-method active" onclick="selectPayment('cash')">
                                <i class="bi bi-cash-coin"></i>
                                <div>Paiement à la livraison</div>
                            </div>
                            <div class="payment-method" onclick="selectPayment('card')">
                                <i class="bi bi-credit-card"></i>
                                <div>Carte Gold</div>
                            </div>
                            <div class="payment-method" onclick="selectPayment('edahabia')">
                                <i class="bi bi-phone"></i>
                                <div>Edahabia</div>
                            </div>
                        </div>
                        
                        <input type="hidden" id="selectedPayment" value="cash">
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Annuler</button>
                    <button type="button" class="btn btn-orange" onclick="submitQuickOrder()">
                        <i class="bi bi-send-check"></i> Confirmer la commande
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

    <script>
        // Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyBTrnKCYOtfSSDYtmVQbzP2HcwgkLT565Y",
            authDomain: "robuste-c8e0f.firebaseapp.com",
            projectId: "robuste-c8e0f",
            storageBucket: "robuste-c8e0f.appspot.com",
            messagingSenderId: "975609984963",
            appId: "1:975609984963:web:a481efb493a88d7bc7af76",
            measurementId: "G-DWT7MZN028"
        };

        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();

        // Initialize EmailJS
        (function() {
            emailjs.init("k77vdaUWPpnLrfTnS");
        })();

        // Shopping cart management - UPDATED TO MATCH INDEX.HTML
        let cart = [];
        let currentProduct = null;
        let relatedProducts = [];

        // Load cart from localStorage
        function loadCart() {
            try {
                const cartData = localStorage.getItem('robuste_cart');
                if (cartData) {
                    cart = JSON.parse(cartData);
                }
            } catch (e) {
                console.error('Erreur lors du chargement du panier:', e);
                cart = [];
            }
            updateCartCount();
            renderCart();
        }

        // Update cart counter
        function updateCartCount() {
            const cartCount = document.getElementById('cartCount');
            const checkoutBtn = document.getElementById('checkoutBtn');
            
            if (!cartCount || !checkoutBtn) return;
            
            const count = cart.reduce((total, item) => total + (item.quantity || 0), 0);
            cartCount.textContent = count;
            checkoutBtn.disabled = count === 0;
        }

        // Render cart items
        function renderCart() {
            const cartItems = document.getElementById('cartItems');
            const emptyCartMessage = document.getElementById('emptyCartMessage');
            const cartTotal = document.getElementById('cartTotal');
            
            if (!cartItems || !cartTotal) return;
            
            // Clear current content
            while (cartItems.firstChild) {
                cartItems.removeChild(cartItems.firstChild);
            }
            
            if (cart.length === 0) {
                const emptyDiv = document.createElement('div');
                emptyDiv.className = 'text-center py-4 text-muted';
                emptyDiv.id = 'emptyCartMessage';
                emptyDiv.innerHTML = '<i class="bi bi-cart-x display-4 d-block mb-2"></i>سلة المشتريات فارغة';
                cartItems.appendChild(emptyDiv);
                cartTotal.textContent = '0 د.ج';
                return;
            }
            
            let total = 0;
            cart.forEach((item, index) => {
                const itemTotal = (item.price || 0) * (item.quantity || 0);
                total += itemTotal;
                
                const itemElement = document.createElement('div');
                itemElement.className = 'cart-item';
                itemElement.dataset.id = item.id || '';
                
                itemElement.innerHTML = `
                    <div class="d-flex">
                        <img src="${item.image || ''}" alt="${item.name || 'منتج'}" class="cart-item-img me-3" style="width: 80px; height: 80px; object-fit: contain; border-radius: 8px; background-color: #f8f8f8; padding: 5px;">
                        <div class="cart-item-details">
                            <div class="cart-item-title">${item.name || 'منتج بدون اسم'}</div>
                            <div class="cart-item-price">${item.price || 0} د.ج</div>
                            <div class="quantity-controls">
                                <button class="quantity-btn" data-action="decrease" data-index="${index}">-</button>
                                <input type="number" class="quantity-input" value="${item.quantity || 1}" min="1" data-index="${index}">
                                <button class="quantity-btn" data-action="increase" data-index="${index}">+</button>
                            </div>
                        </div>
                        <button class="remove-item align-self-start" data-index="${index}">
                            <i class="bi bi-trash"></i>
                        </button>
                    </div>
                `;
                
                cartItems.appendChild(itemElement);
            });
            
            cartTotal.textContent = `${total.toLocaleString('ar-DZ')} د.ج`;
            
            // Add event listeners after rendering
            attachCartEventListeners();
        }

        // Add event listeners to cart items
        function attachCartEventListeners() {
            // Quantity buttons
            document.querySelectorAll('.quantity-btn').forEach(btn => {
                btn.addEventListener('click', function(e) {
                    const index = parseInt(this.dataset.index);
                    const action = this.dataset.action;
                    
                    if (isNaN(index) || index < 0 || index >= cart.length) return;
                    
                    if (action === 'increase') {
                        updateQuantity(index, cart[index].quantity + 1);
                    } else if (action === 'decrease') {
                        updateQuantity(index, cart[index].quantity - 1);
                    }
                });
            });
            
            // Quantity inputs
            document.querySelectorAll('.quantity-input').forEach(input => {
                input.addEventListener('change', function(e) {
                    const index = parseInt(this.dataset.index);
                    if (isNaN(index) || index < 0 || index >= cart.length) return;
                    
                    const newQuantity = parseInt(this.value) || 1;
                    updateQuantity(index, newQuantity);
                });
                
                // Prevent non-numeric input
                input.addEventListener('keydown', function(e) {
                    if (!/[\d\b\t\n]|Arrow|Delete|Backspace|Tab/.test(e.key) && 
                        !(e.ctrlKey || e.metaKey)) {
                        e.preventDefault();
                    }
                });
            });
            
            // Remove buttons
            document.querySelectorAll('.remove-item').forEach(btn => {
                btn.addEventListener('click', function(e) {
                    const index = parseInt(this.dataset.index);
                    if (isNaN(index) || index < 0 || index >= cart.length) return;
                    
                    removeFromCart(index);
                });
            });
        }

        // Update item quantity
        function updateQuantity(index, newQuantity) {
            if (isNaN(index) || index < 0 || index >= cart.length) return;
            
            if (newQuantity < 1) {
                removeFromCart(index);
                return;
            }
            
            cart[index].quantity = newQuantity;
            
            try {
                localStorage.setItem('robuste_cart', JSON.stringify(cart));
            } catch (e) {
                console.error('Erreur lors de la mise à jour du panier:', e);
            }
            
            renderCart();
            updateCartCount();
        }

        // Remove item from cart
        function removeFromCart(index) {
            if (isNaN(index) || index < 0 || index >= cart.length) return;
            
            const productName = cart[index].name || 'منتج';
            cart.splice(index, 1);
            
            try {
                localStorage.setItem('robuste_cart', JSON.stringify(cart));
            } catch (e) {
                console.error('Erreur lors de la mise à jour du panier:', e);
            }
            
            renderCart();
            updateCartCount();
            showStatus(`تمت إزالة "${productName}" من السلة`, 'success');
        }

        // Add product to cart
        function addToCart(productName, productPrice, priceValue, productImages, productId) {
            const name = typeof productName === 'string' ? productName : 'Produit sans nom';
            const price = typeof priceValue === 'number' ? priceValue : 
                         typeof productPrice === 'number' ? productPrice : 0;
            const id = productId || Date.now().toString();
            
            let image = '';
            if (Array.isArray(productImages) && productImages.length > 0) {
                image = productImages[0];
            } else if (typeof productImages === 'string') {
                image = productImages;
            }
            
            const existingItemIndex = cart.findIndex(item => item.id === id);
            
            if (existingItemIndex >= 0) {
                cart[existingItemIndex].quantity += 1;
            } else {
                cart.push({
                    id: id,
                    name: name,
                    price: price,
                    image: image,
                    quantity: 1
                });
            }
            
            try {
                localStorage.setItem('robuste_cart', JSON.stringify(cart));
            } catch (e) {
                console.error('Erreur lors de la sauvegarde du panier:', e);
                showStatus('Impossible de sauvegarder le panier, la mémoire de stockage peut être pleine', 'error');
            }
            
            updateCartCount();
            renderCart();
            showStatus(`"${name}" a été ajouté au panier`, 'success');
        }

        // Show/hide cart
        function toggleCart() {
            if (cart.length === 0) {
                showStatus('Le panier est vide', 'info');
                return;
            }
            
            try {
                const cartOffcanvas = new bootstrap.Offcanvas(document.getElementById('cartOffcanvas'));
                cartOffcanvas.show();
            } catch (e) {
                console.error('Erreur lors de l\'ouverture du panier:', e);
                document.getElementById('cartOffcanvas').classList.add('show');
                document.body.classList.add('offcanvas-open');
            }
        }

        // Checkout function
        function checkout() {
            // Redirect to index.html for checkout
            window.location.href = 'index.html';
        }

        // Load product data
        async function loadProduct() {
            const urlParams = new URLSearchParams(window.location.search);
            const productId = parseInt(urlParams.get('pid'));
            
            if (!productId) {
                showProductError('ID de produit non spécifié');
                return;
            }
            
            try {
                const response = await fetch('products.json');
                
                if (!response.ok) {
                    throw new Error('Erreur lors du chargement des produits');
                }
                
                const products = await response.json();
                const product = products.find(p => p.id === productId);
                
                if (!product) {
                    showProductError('Produit non trouvé');
                    return;
                }
                
                currentProduct = product;
                renderProduct(product);
                loadRelatedProducts(product.category, product.id);
                populateWilayas();
            } catch (error) {
                console.error('Erreur:', error);
                showProductError('Erreur lors du chargement du produit');
            }
        }

        // Load related products
        async function loadRelatedProducts(category, currentProductId) {
            try {
                const response = await fetch('products.json');
                const products = await response.json();
                
                // Filter products with same category except current product
                relatedProducts = products.filter(p => 
                    p.category === category && p.id !== currentProductId
                ).slice(0, 8); // Take first 8 products
                
                renderRelatedProducts();
            } catch (error) {
                console.error('Erreur lors du chargement des produits similaires:', error);
            }
        }

        // Display related products
        function renderRelatedProducts() {
            const track = document.getElementById('productsTrack');
            
            if (relatedProducts.length === 0) {
                track.innerHTML = '<p class="text-center text-muted">Aucun produit similaire trouvé</p>';
                return;
            }
            
            track.innerHTML = relatedProducts.map(product => `
                <div class="product-slide fade-in">
                    <img src="${product.images[0]}" alt="${product.title}" loading="lazy">
                    <div class="product-slide-content">
                        <h6 class="fw-bold">${product.title}</h6>
                        <p class="text-muted small mb-2">${product.description_short}</p>
                        <div class="d-flex justify-content-between align-items-center">
                            <span class="fw-bold text-primary">${product.price.toLocaleString()} د.ج</span>
                            <a href="product.html?pid=${product.id}" class="btn btn-sm btn-outline-primary">
                                Voir
                            </a>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        // Slide related products
        function slideProducts(direction) {
            const track = document.getElementById('productsTrack');
            const scrollAmount = 270; // Product width + gap
            track.scrollBy({ left: direction * scrollAmount, behavior: 'smooth' });
        }

        // Populate wilayas list
        function populateWilayas() {
            const wilayas = [
                "Adrar", "Chlef", "Laghouat", "Oum El Bouaghi", "Batna", "Béjaïa", "Biskra", "Béchar", "Blida",
                "Bouira", "Tamanrasset", "Tébessa", "Tlemcen", "Tiaret", "Tizi Ouzou", "Alger", "Djelfa", "Jijel",
                "Sétif", "Saïda", "Skikda", "Sidi Bel Abbès", "Annaba", "Guelma", "Constantine", "Médéa", "Mostaganem",
                "M'Sila", "Mascara", "Ouargla", "Oran", "El Bayadh", "Illizi", "Bordj Bou Arréridj", "Boumerdès", "El Tarf",
                "Tindouf", "Tissemsilt", "El Oued", "Khenchela", "Souk Ahras", "Tipaza", "Mila", "Aïn Defla", "Naâma",
                "Aïn Témouchent", "Ghardaïa", "Relizane"
            ];
            
            const wilayaSelect = document.getElementById('quickWilaya');
            wilayas.forEach(wilaya => {
                const option = document.createElement('option');
                option.value = wilaya;
                option.textContent = wilaya;
                wilayaSelect.appendChild(option);
            });
        }

        // Display product
        function renderProduct(product) {
            const container = document.getElementById('productContainer');
            
            // Calculate discount percentage
            const discountPercentage = product.old_price ? 
                Math.round(((product.old_price - product.price) / product.old_price) * 100) : 0;
            
            // Create image gallery
            const thumbnails = product.images.map((img, index) => `
                <div class="thumbnail ${index === 0 ? 'active' : ''}" onclick="changeMainImage('${img}', this)">
                    <img src="${img}" alt="Miniature ${index + 1}" loading="lazy">
                </div>
            `).join('');
            
            // Create features list
            const featuresList = product.features.map(feature => `
                <li>${feature}</li>
            `).join('');
            
            container.innerHTML = `
                <div class="product-gallery">
                    <div class="main-image">
                        <img src="${product.images[0]}" alt="${product.title}" id="mainProductImage">
                    </div>
                    <div class="thumbnails">
                        ${thumbnails}
                    </div>
                </div>
                
                <div class="product-info slide-in-up">
                    <h1 class="product-title">${product.title}</h1>
                    
                    <div class="rating">
                        <div class="stars">
                            <i class="bi bi-star-fill"></i>
                            <i class="bi bi-star-fill"></i>
                            <i class="bi bi-star-fill"></i>
                            <i class="bi bi-star-fill"></i>
                            <i class="bi bi-star-half"></i>
                        </div>
                        <span class="rating-text">(4.2) · 128 avis</span>
                    </div>
                    
                    <div class="price-section">
                        ${product.old_price ? `
                            <span class="discount">-${discountPercentage}%</span>
                            <span class="old-price">${product.old_price.toLocaleString()} د.ج</span>
                        ` : ''}
                        <span class="current-price">${product.price.toLocaleString()} د.ج</span>
                    </div>
                    
                    <p class="lead">${product.description_short}</p>
                    
                    <div class="features-list">
                        <ul>
                            ${featuresList}
                        </ul>
                    </div>
                    
                    <div class="stock-info ${product.stock > 0 ? 'in-stock' : ''}">
                        <i class="bi ${product.stock > 0 ? 'bi-check-circle-fill' : 'bi-x-circle-fill'}"></i>
                        <span>${product.stock > 0 ? `En stock (${product.stock} disponible${product.stock > 1 ? 's' : ''})` : 'Rupture de stock'}</span>
                    </div>
                    
                    <div class="action-buttons">
                        <button class="btn-orange" onclick="addToCart('${product.title}', '${product.price.toLocaleString()} د.ج', ${product.price}, ['${product.images.join("','")}'], ${product.id})">
                            <i class="bi bi-cart-plus"></i> Ajouter au panier
                        </button>
                        <button class="btn-outline-orange" onclick="openQuickOrder('${product.title}', ${product.price}, '${product.images[0]}', ${product.id})">
                            <i class="bi bi-lightning"></i> Commander maintenant
                        </button>
                    </div>
                    
                    <div class="shipping-info">
                        <div class="item">
                            <i class="bi bi-truck"></i>
                            <span>Livraison gratuite à partir de 5000 د.ج</span>
                        </div>
                        <div class="item">
                            <i class="bi bi-shield-check"></i>
                            <span>Garantie 2 ans incluse</span>
                        </div>
                        <div class="item">
                            <i class="bi bi-arrow-clockwise"></i>
                            <span>Retour facile sous 14 jours</span>
                        </div>
                    </div>
                </div>
            `;
        }

        // Change main image
        function changeMainImage(src, element) {
            document.getElementById('mainProductImage').src = src;
            
            // Remove active from all thumbnails
            document.querySelectorAll('.thumbnail').forEach(thumb => {
                thumb.classList.remove('active');
            });
            
            // Add active to selected image
            element.classList.add('active');
        }

        // Open quick order modal
        function openQuickOrder(productName, productPrice, productImage, productId) {
            document.getElementById('orderProductName').textContent = productName;
            document.getElementById('orderProductPrice').textContent = productPrice.toLocaleString() + ' د.ج';
            document.getElementById('orderProductImage').src = productImage;
            
            // Save product data for the system
            window.quickOrderProduct = {
                name: productName,
                price: productPrice,
                image: productImage,
                id: productId
            };
            
            const orderModal = new bootstrap.Modal(document.getElementById('orderModal'));
            orderModal.show();
        }

        // Select payment method
        function selectPayment(method) {
            document.getElementById('selectedPayment').value = method;
            
            // Remove active from all methods
            document.querySelectorAll('.payment-method').forEach(item => {
                item.classList.remove('active');
            });
            
            // Add active to selected method
            event.currentTarget.classList.add('active');
        }

        // Submit quick order
        async function submitQuickOrder() {
            const fullName = document.getElementById('quickFullName').value;
            const phone = document.getElementById('quickPhone').value;
            const email = document.getElementById('quickEmail').value || 'Non fourni';
            const wilaya = document.getElementById('quickWilaya').value;
            const address = document.getElementById('quickAddress').value || 'Non spécifiée';
            const paymentMethod = document.getElementById('selectedPayment').value;
            
            // Validate data
            if (!fullName || !phone || !wilaya) {
                showStatus('Veuillez remplir tous les champs obligatoires', 'error');
                return;
            }
            
            const phoneRegex = /^0[5-7][0-9]{8}$/;
            if (!phoneRegex.test(phone)) {
                showStatus('Numéro de téléphone invalide. Doit contenir 10 chiffres et commencer par 05, 06 ou 07', 'error');
                return;
            }
            
            const orderData = {
                product: window.quickOrderProduct.name,
                productPrice: window.quickOrderProduct.price,
                totalPrice: window.quickOrderProduct.price,
                customer: fullName,
                phone: phone,
                email: email,
                wilaya: wilaya,
                address: address,
                payment: paymentMethod,
                timestamp: new Date().toISOString(),
                status: 'Nouveau'
            };
            
            // Show loading status
            showStatus('Traitement de votre commande...', 'loading');
            
            const submitBtn = document.querySelector('#orderModal .btn-orange');
            submitBtn.disabled = true;
            submitBtn.innerHTML = `
                <span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>
                Traitement...
            `;
            
            try {
                // Store order in Firebase
                const docRef = await db.collection('orders').add(orderData);
                
                // Send email
                await emailjs.send("service_lc1q5k8", "template_a15g7yg", {
                    order_id: docRef.id,
                    customer_name: fullName,
                    customer_phone: phone,
                    customer_email: email,
                    wilaya: wilaya,
                    address: address,
                    total_price: window.quickOrderProduct.price.toLocaleString(),
                    payment_method: paymentMethod,
                    order_date: new Date().toLocaleString('fr-FR'),
                    product_name: window.quickOrderProduct.name
                });
                
                // Success message
                showStatus(`Commande confirmée! Numéro: ${docRef.id}. Nous vous contacterons au ${phone} dans les 24 heures.`, 'success');
                
                // Close modal and reset form
                const orderModal = bootstrap.Modal.getInstance(document.getElementById('orderModal'));
                orderModal.hide();
                document.getElementById('quickOrderForm').reset();
                
            } catch (error) {
                console.error('Erreur:', error);
                showStatus('Erreur lors de l\'envoi de la commande. Veuillez réessayer.', 'error');
            } finally {
                submitBtn.disabled = false;
                submitBtn.innerHTML = '<i class="bi bi-send-check"></i> Confirmer la commande';
            }
        }

        // Show product error
        function showProductError(message) {
            const container = document.getElementById('productContainer');
            container.innerHTML = `
                <div class="col-12 text-center py-5">
                    <i class="bi bi-exclamation-triangle display-1 text-danger"></i>
                    <h3 class="mt-3">${message}</h3>
                    <p class="mb-4">Nous n'avons pas pu trouver le produit demandé.</p>
                    <a href="index.html" class="btn btn-orange btn-lg">
                        <i class="bi bi-arrow-left"></i> Retour à l'accueil
                    </a>
                </div>
            `;
        }

        // Status display functions
        function showStatus(message, type) {
            const indicator = document.getElementById('statusIndicator');
            const messageElement = document.getElementById('statusMessage');
            
            messageElement.innerHTML = message;
            
            const alert = indicator.querySelector('.alert');
            alert.className = 'alert alert-dismissible fade show';
            
            switch (type) {
                case 'success':
                    alert.classList.add('alert-success', 'order-confirmation');
                    break;
                case 'error':
                    alert.classList.add('alert-danger', 'order-error');
                    break;
                case 'info':
                    alert.classList.add('alert-info');
                    break;
                case 'loading':
                    alert.classList.add('alert-info');
                    messageElement.innerHTML = `
                        <span class="spinner-border spinner-border-sm me-2" role="status"></span>
                        ${message}
                    `;
                    break;
                default:
                    alert.classList.add('alert-info');
            }
            
            indicator.style.display = 'block';
            
            if (type === 'success') {
                setTimeout(hideStatus, 5000);
            }
        }

        function hideStatus() {
            document.getElementById('statusIndicator').style.display = 'none';
        }

        // Page initialization
        document.addEventListener('DOMContentLoaded', function() {
            loadCart(); // Load cart from localStorage
            loadProduct();
        });
    </script>
</body>
</html>
